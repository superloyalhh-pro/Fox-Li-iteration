
function varargout = fox(varargin)
%      FOX M-file for fox.fig
%      FOX, by itself, creates a new FOX or raises the existing
%      singleton*.
%
%      H = FOX returns the handle to a new FOX or the handle to
%      the existing singleton*.
%
%      FOX('CALLBACK',hObject,eventData,handles,...) calls the local
%      function named CALLBACK in FOX.M with the given input arguments.
%
%      FOX('Property','Value',...) creates a new FOX or raises the
%      existing singleton*.  Starting from the left, property value pairs are
%      applied to the GUI before fox_OpeningFunction gets called.  An
%      unrecognized property name or invalid value makes property application
%      stop.  All inputs are passed to fox_OpeningFcn via varargin.
%
%      *See GUI Options on GUIDE's Tools menu.  Choose "GUI allows only one
%      instance to run (singleton)".
%
% See also: GUIDE, GUIDATA, GUIHANDLES

% Copyright 2002-2003 The MathWorks, Inc.

% Edit the above text to modify the response to help fox

% Last Modified by GUIDE v2.5 26-May-2011 23:53:08

% Begin initialization code - DO NOT EDIT
gui_Singleton = 1;
gui_State = struct('gui_Name',       mfilename, ...
                   'gui_Singleton',  gui_Singleton, ...
                   'gui_OpeningFcn', @fox_OpeningFcn, ...
                   'gui_OutputFcn',  @fox_OutputFcn, ...
                   'gui_LayoutFcn',  [] , ...
                   'gui_Callback',   []);
if nargin && ischar(varargin{1})
    gui_State.gui_Callback = str2func(varargin{1});
end

if nargout
    [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
else
    gui_mainfcn(gui_State, varargin{:});
end
% End initialization code - DO NOT EDIT



% --- Executes just before fox is made visible.
function fox_OpeningFcn(hObject, eventdata, handles, varargin)
% This function has no output args, see OutputFcn.
% hObject    handle to figure
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
% varargin   command line arguments to fox (see VARARGIN)

% Choose default command line output for fox
handles.output = hObject;

% Update handles structure
guidata(hObject, handles);

% UIWAIT makes fox wait for user response (see UIRESUME)
% uiwait(handles.figure1);


% --- Outputs from this function are returned to the command line.
function varargout = fox_OutputFcn(hObject, eventdata, handles) 
% varargout  cell array for returning output args (see VARARGOUT);
% hObject    handle to figure
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Get default command line output from handles structure
varargout{1} = handles.output;



function edit1_Callback(hObject, eventdata, handles)
% hObject    handle to edit1 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit1 as text
%        str2double(get(hObject,'String')) returns contents of edit1 as a double


% --- Executes during object creation, after setting all properties.
function edit1_CreateFcn(hObject, eventdata, handles)
% hObject    handle to edit1 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc
    set(hObject,'BackgroundColor','white');
else
    set(hObject,'BackgroundColor',get(0,'defaultUicontrolBackgroundColor'));
end



function edit3_Callback(hObject, eventdata, handles)
% hObject    handle to edit3 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit3 as text
%        str2double(get(hObject,'String')) returns contents of edit3 as a
%        double


% --- Executes during object creation, after setting all properties.
function edit3_CreateFcn(hObject, eventdata, handles)
% hObject    handle to edit3 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc
    set(hObject,'BackgroundColor','white');
else
    set(hObject,'BackgroundColor',get(0,'defaultUicontrolBackgroundColor'));
end



function edit4_Callback(hObject, eventdata, handles)
% hObject    handle to edit4 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit4 as text
%        str2double(get(hObject,'String')) returns contents of edit4 as a double


% --- Executes during object creation, after setting all properties.
function edit4_CreateFcn(hObject, eventdata, handles)
% hObject    handle to edit4 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc
    set(hObject,'BackgroundColor','white');
else
    set(hObject,'BackgroundColor',get(0,'defaultUicontrolBackgroundColor'));
end


% --- Executes on selection change in popupmenu1.
function popupmenu1_Callback(hObject, eventdata, handles)
% hObject    handle to popupmenu1 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: contents = get(hObject,'String') returns popupmenu1 contents as cell array
%        contents{get(hObject,'Value')} returns selected item from popupmenu1
%∂¡»°«ª–Õ
global style;
style=get(hObject,'Value');
if style==1
    set(handles.edit3,'enable','off');
    set(handles.edit4,'enable','off');
    set(handles.edit5,'enable','off');
    set(handles.edit6,'enable','off');
    set(handles.edit13,'enable','off');
    set(handles.edit15,'enable','off');
    set(handles.edit17,'enable','off');
    set(handles.edit1,'enable','off');
    set(handles.edit7,'enable','off');
    set(handles.edit8,'enable','off');
    set(handles.edit10,'enable','off');
    set(handles.pushbutton6,'enable','off');
    set(handles.pushbutton7,'enable','off');
    set(handles.popupmenu3,'enable','off');
    set(handles.pushbutton1,'enable','off');
    set(handles.pushbutton3,'enable','off');
else
    set(handles.edit3,'enable','on');
    set(handles.edit4,'enable','on');
    set(handles.edit5,'enable','on');
    set(handles.edit7,'enable','on');
    set(handles.edit1,'enable','on');
    set(handles.popupmenu3,'enable','on');
    set(handles.pushbutton1,'enable','on');
    set(handles.pushbutton3,'enable','on');
    set(handles.edit15,'enable','on');
    set(handles.pushbutton6,'enable','on');
    set(handles.pushbutton7,'enable','on');
    if style==2 % Ãı–Õ«ª
        axes(handles.axes3);
        pic=imread('Ãı–Œ«ª.png');
        imshow(pic);
        set(handles.edit6,'enable','off');
        set(handles.edit8,'enable','off');
        set(handles.edit10,'enable','off');
        set(handles.edit13,'enable','off');
        set(handles.edit17,'enable','off');
    elseif style==3 % æÿ–Œ«ª
        axes(handles.axes3);
        pic=imread('æÿ–Œ«ª.png');
        imshow(pic);
        set(handles.edit6,'enable','on');
        set(handles.edit8,'enable','off');
        set(handles.edit10,'enable','off');
        set(handles.edit13,'enable','off');
        set(handles.edit17,'enable','off');
    elseif style==4 % ‘≤–Œ∆Ω√Êæµ
        axes(handles.axes3);
        pic=imread('‘≤–Œæµ.png');
        imshow(pic);
        set(handles.edit6,'enable','off');
        set(handles.edit8,'enable','on');
        set(handles.edit10,'enable','on');
        set(handles.edit13,'enable','off');
        set(handles.edit17,'enable','off');
    elseif style==5 || style==6 % ∞ºÕπ√Êæµ
        axes(handles.axes3);
        pic=imread('‘≤–Œ«ª.png');
        imshow(pic);
        set(handles.edit6,'enable','on');
        set(handles.edit8,'enable','on');
        set(handles.edit10,'enable','on');
        set(handles.edit13,'enable','off');
        set(handles.edit17,'enable','on');
    elseif style==7 % «„–±«ª
        axes(handles.axes3);
        pic=imread('«„–±«ª.png');
        imshow(pic);
        set(handles.edit6,'enable','on');
        set(handles.edit8,'enable','off');
        set(handles.edit10,'enable','off');
        set(handles.edit13,'enable','on');
        set(handles.edit17,'enable','off');
    end
end
guidata(hObject, handles);


% --- Executes during object creation, after setting all properties.
function popupmenu1_CreateFcn(hObject, eventdata, handles)
% hObject    handle to popupmenu1 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: popupmenu controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc
    set(hObject,'BackgroundColor','white');
else
    set(hObject,'BackgroundColor',get(0,'defaultUicontrolBackgroundColor'));
end
global style;
style=1;

function edit5_Callback(hObject, ~, handles)
% hObject    handle to edit5 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit5 as text
%        str2double(get(hObject,'String')) returns contents of edit5 as a
%        double

% --- Executes during object creation, after setting all properties.
function edit5_CreateFcn(hObject, eventdata, handles)
% hObject    handle to edit5 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc
    set(hObject,'BackgroundColor','white');
else
    set(hObject,'BackgroundColor',get(0,'defaultUicontrolBackgroundColor'));
end



function edit6_Callback(hObject, eventdata, handles)
% hObject    handle to edit6 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit6 as text
%        str2double(get(hObject,'String')) returns contents of edit6 as a double


% --- Executes during object creation, after setting all properties.
function edit6_CreateFcn(hObject, eventdata, handles)
% hObject    handle to edit6 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.

if ispc
    set(hObject,'BackgroundColor','white');
else
    set(hObject,'BackgroundColor',get(0,'defaultUicontrolBackgroundColor'));
end



% --- Executes during object creation, after setting all properties.
function text9_CreateFcn(hObject, eventdata, handles)
% hObject    handle to text9 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called




% --- Executes on button press in pushbutton1.
function pushbutton1_Callback(hObject, eventdata, handles)
% hObject    handle to pushbutton1 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
global style;
global calmeans;
tic;% ø™ ºº∆ ±
% ∂¡»°≤Œ ˝
iteration = str2num(get(handles.edit1,'String')); % ∂…‘Ω¥Œ ˝
error_margin = iteration/1000; % ŒÛ≤Ó»›œﬁ
wavelength = str2double(get(handles.edit3,'String'));
wavelength = wavelength*10^-9; % ≤®≥§
Ltimes = str2double(get(handles.edit4,'String'));
L = Ltimes*wavelength; % L
k = 2*pi/wavelength; % ≤® ˝
atimes = str2double(get(handles.edit5,'String'));
a = atimes*wavelength; % a
btimes = str2double(get(handles.edit6,'String'));
b = btimes*wavelength; % b
discrete = str2num(get(handles.edit7,'String')); % ¿Î…¢≥Ã∂»
ctimes = str2double(get(handles.edit13,'String'));
c = ctimes*wavelength; % c

% ‘≤–Œ”–πÿ≤Œ ˝
dir=str2num(get(handles.edit8,'String')); % Ω«œÚ±∂ ˝
nu=str2num(get(handles.edit10,'String')); % ±¥»˚∂˚Ω◊ ˝
Neq=a^2/(wavelength*L); % ∑∆ƒ˘∂˙ ˝
error=0; % ≥ı ºŒÛ≤Ó

if calmeans ==1 % ∞¥∂…‘Ω¥Œ ˝º∆À„
    switch style
        case 2 % Ãı–Œ«ª
            [modulus,phase,error,modulus_pre,phase_pre]=Fox_Li_1(iteration,a,k,L,discrete);
            %axes(handles.axes1);
            figure
            figure(gcf)
            set(gcf,'name','’Ò∑˘∑÷≤º','numberTitle','off');
            plot(linspace(-1,1,discrete),modulus,'r');% ª≠◊Ó∫Û’Ò∑˘
            hold on;
            plot(linspace(-1,1,discrete),modulus_pre,'b--');% ª≠µπ ˝µ⁄∂˛¥Œ’Ò∑˘
            legend(['µ⁄' num2str(iteration) '¥Œ'],['µ⁄' num2str(iteration-1) '¥Œ'],'Location','Best');
            hold off;
            grid on;
            title({'Ãı–Œ«ª’Ò∑˘∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
            figure
            figure(gcf)
            set(gcf,'name','œ‡Œª∑÷≤º','numberTitle','off');
            plot(linspace(-1,1,discrete),phase,'r');% ª≠◊Ó∫Ûœ‡Œª
            hold on;
            plot(linspace(-1,1,discrete),phase_pre,'b--');% ª≠µπ ˝µ⁄∂˛¥Œœ‡Œª
            legend(['µ⁄' num2str(iteration) '¥Œ'],['µ⁄' num2str(iteration-1) '¥Œ'],'Location','Best');
            hold off;
            grid on;
            title({'Ãı–Œ«ªœ‡Œª∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
        case 3 % æÿ–Œ«ª
            [modulus_a,phase_a,error_a]=Fox_Li_1(iteration,a,k,L,discrete);
            [modulus_b,phase_b,error_b]=Fox_Li_1(iteration,b,k,L,discrete);
            error=max(error_a,error_b);
            figure
            figure(gcf)
            set(gcf,'name','’Ò∑˘∑÷≤º','numberTitle','off');
            mesh(linspace(-1,1,discrete),linspace(-1,1,discrete),modulus_a'*modulus_b);
            shading interp
            colormap summer;
            grid on;
            title({'æÿ–Œ«ª’Ò∑˘∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§ b£∫' num2str(btimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
            figure
            figure(gcf)
            set(gcf,'name','œ‡Œª∑÷≤º','numberTitle','off');
            mesh(linspace(-1,1,discrete),linspace(-1,1,discrete),phase_a'*phase_b);
            shading interp
            colormap summer;
            grid on;
            title({'æÿ–Œ«ªœ‡Œª∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§ b£∫' num2str(btimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
        case 4 % ‘≤–Œ∆Ω√Êæµ
            [U,V,X,Y,error]=Fox_Li_3(iteration,a,inf,k,L,discrete,nu,dir,Neq);
            figure
            figure(gcf)
            set(gcf,'name','’Ò∑˘∑÷≤º','numberTitle','off');
            meshc(X,Y,U);
            shading interp
            colormap summer;
            title({'‘≤–Œ∆Ω√Êæµ’Ò∑˘∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['Ω«œÚ±∂ ˝£∫' num2str(dir) '  ±¥»˚∂˚Ω◊ ˝£∫' num2str(nu)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
            figure
            figure(gcf)
            set(gcf,'name','œ‡Œª∑÷≤º','numberTitle','off');
            meshc(X,Y,V);
            shading interp
            colormap summer;
            title({'‘≤–Œ∆Ω√Êæµœ‡Œª∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['Ω«œÚ±∂ ˝£∫' num2str(dir) '  ±¥»˚∂˚Ω◊ ˝£∫' num2str(nu)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
        case {5,6} % ∞º√Êæµ£¨Õπ√Êæµ
            [U,V,X,Y,error]=Fox_Li_3(iteration,a,b,k,L,discrete,nu,dir,Neq);
            figure
            figure(gcf)
            set(gcf,'name','’Ò∑˘∑÷≤º','numberTitle','off');
            meshc(X,Y,U);
            shading interp
            colormap summer;
            title({'∞º√Êæµ/Õπ√Êæµ’Ò∑˘∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§ b£∫' num2str(btimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['Ω«œÚ±∂ ˝£∫' num2str(dir) '  ±¥»˚∂˚Ω◊ ˝£∫' num2str(nu)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
            figure
            figure(gcf)
            set(gcf,'name','œ‡Œª∑÷≤º','numberTitle','off');
            meshc(X,Y,V);
            shading interp
            colormap summer;
            title({'∞º√Êæµ/Õπ√Êæµœ‡Œª∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§ b£∫' num2str(btimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['Ω«œÚ±∂ ˝£∫' num2str(dir) '  ±¥»˚∂˚Ω◊ ˝£∫' num2str(nu)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
        case 7 % «„–±«ª
            [modulus_a,phase_a,error_a]=Fox_Li_4(iteration,a,c,k,L,discrete);
            [modulus_b,phase_b,error_b]=Fox_Li_1(iteration,b,k,L,discrete);
            error=max(error_a,error_b);
            figure
            figure(gcf)
            set(gcf,'name','’Ò∑˘∑÷≤º','numberTitle','off');
            mesh(linspace(-1,1,discrete),linspace(-1,1,discrete),modulus_a'*modulus_b);
            shading interp
            colormap summer;
            grid on;
            title({'«„–±«ª’Ò∑˘∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§ b£∫' num2str(btimes) '±∂≤®≥§ c£∫' num2str(ctimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
            figure
            figure(gcf)
            set(gcf,'name','œ‡Œª∑÷≤º','numberTitle','off');
            mesh(linspace(-1,1,discrete),linspace(-1,1,discrete),phase_a'*phase_b);
            shading interp
            colormap summer;
            grid on;
            title({'«„–±«ªœ‡Œª∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§ b£∫' num2str(btimes) '±∂≤®≥§ c£∫' num2str(ctimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
    end
else % ∞¥ŒÛ≤Ó»›œﬁº∆À„
    switch style
        case 2 % Ãı–Œ«ª
            [modulus,phase,iteration,error,modulus_pre,phase_pre]=Fox_Li_2(error_margin,a,k,L,discrete);
            figure
            figure(gcf)
            set(gcf,'name','’Ò∑˘∑÷≤º','numberTitle','off');
            plot(linspace(-1,1,discrete),modulus,'r');% ª≠◊Ó∫Û’Ò∑˘
            hold on;
            plot(linspace(-1,1,discrete),modulus_pre,'b--');% ª≠µπ ˝µ⁄∂˛¥Œ’Ò∑˘
            legend(['µ⁄' num2str(iteration) '¥Œ'],['µ⁄' num2str(iteration-1) '¥Œ'],'Location','Best');
            hold off;
            grid on;
            title({'Ãı–Œ«ª’Ò∑˘∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
            figure
            figure(gcf)
            set(gcf,'name','œ‡Œª∑÷≤º','numberTitle','off');
            plot(linspace(-1,1,discrete),phase,'r');% ª≠◊Ó∫Ûœ‡Œª
            hold on;
            plot(linspace(-1,1,discrete),phase_pre,'b--');% ª≠µπ ˝µ⁄∂˛¥Œœ‡Œª
            legend(['µ⁄' num2str(iteration) '¥Œ'],['µ⁄' num2str(iteration-1) '¥Œ'],'Location','Best');
            hold off;
            grid on;
            title({'Ãı–Œ«ªœ‡Œª∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
        case 3 % æÿ–Œ«ª
            [modulus_a,phase_a,iteration_a,error_a]=Fox_Li_2(error_margin,a,k,L,discrete);
            [modulus_b,phase_b,iteration_b,error_b]=Fox_Li_2(error_margin,b,k,L,discrete);
            iteration=max(iteration_a,iteration_b);
            error=max(error_a,error_b);
            figure
            figure(gcf)
            set(gcf,'name','’Ò∑˘∑÷≤º','numberTitle','off');
            mesh(linspace(-1,1,discrete),linspace(-1,1,discrete),modulus_a'*modulus_b);
            shading interp
            colormap summer;
            grid on;
            title({'æÿ–Œ«ª’Ò∑˘∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§ b£∫' num2str(btimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
            figure
            figure(gcf)
            set(gcf,'name','œ‡Œª∑÷≤º','numberTitle','off');
            mesh(linspace(-1,1,discrete),linspace(-1,1,discrete),phase_a'*phase_b);
            shading interp
            colormap summer;
            grid on;
            title({'æÿ–Œ«ªœ‡Œª∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§ b£∫' num2str(btimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
        case 4 % ‘≤–Œ∆Ω√Êæµ
            [U,V,X,Y,iteration,error]=Fox_Li_5(error_margin,a,inf,k,L,discrete,nu,dir,Neq);
            figure
            figure(gcf)
            set(gcf,'name','’Ò∑˘∑÷≤º','numberTitle','off');
            meshc(X,Y,U);
            shading interp
            colormap summer;
            title({'‘≤–Œ∆Ω√Êæµ’Ò∑˘∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['Ω«œÚ±∂ ˝£∫' num2str(dir) '  ±¥»˚∂˚Ω◊ ˝£∫' num2str(nu)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
            figure
            figure(gcf)
            set(gcf,'name','œ‡Œª∑÷≤º','numberTitle','off');
            meshc(X,Y,V);
            shading interp
            colormap summer;
            title({'‘≤–Œ∆Ω√Êæµœ‡Œª∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['Ω«œÚ±∂ ˝£∫' num2str(dir) '  ±¥»˚∂˚Ω◊ ˝£∫' num2str(nu)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
        case {5,6} % ∞º√Êæµ£¨Õπ√Êæµ
            [U,V,X,Y,iteration,error]=Fox_Li_5(error_margin,a,b,k,L,discrete,nu,dir,Neq);
            figure
            figure(gcf)
            set(gcf,'name','’Ò∑˘∑÷≤º','numberTitle','off');
            meshc(X,Y,U);
            shading interp
            colormap summer;
            title({'∞º√Êæµ/Õπ√Êæµ’Ò∑˘∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§ b£∫' num2str(btimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['Ω«œÚ±∂ ˝£∫' num2str(dir) '  ±¥»˚∂˚Ω◊ ˝£∫' num2str(nu)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
            figure
            figure(gcf)
            set(gcf,'name','œ‡Œª∑÷≤º','numberTitle','off');
            meshc(X,Y,V);
            shading interp
            colormap summer;
            title({'∞º√Êæµ/Õπ√Êæµœ‡Œª∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§ b£∫' num2str(btimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['Ω«œÚ±∂ ˝£∫' num2str(dir) '  ±¥»˚∂˚Ω◊ ˝£∫' num2str(nu)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
        case 7 % «„–±«ª
            [modulus_a,phase_a,iteration,error_a]=Fox_Li_6(error_margin,a,c,k,L,discrete);
            [modulus_b,phase_b,error_b]=Fox_Li_1(iteration,b,k,L,discrete);
            error=max(error_a,error_b);
            figure
            figure(gcf)
            set(gcf,'name','’Ò∑˘∑÷≤º','numberTitle','off');
            mesh(linspace(-1,1,discrete),linspace(-1,1,discrete),modulus_a'*modulus_b);
            shading interp
            colormap summer;
            grid on;
            title({'«„–±«ª’Ò∑˘∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§  b£∫' num2str(btimes) '±∂≤®≥§  c£∫' num2str(ctimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
            figure
            figure(gcf)
            set(gcf,'name','œ‡Œª∑÷≤º','numberTitle','off');
            mesh(linspace(-1,1,discrete),linspace(-1,1,discrete),phase_a'*phase_b);
            shading interp
            colormap summer;
            grid on;
            title({'«„–±«ªœ‡Œª∑÷≤º';['a£∫' num2str(atimes) '±∂≤®≥§  b£∫' num2str(btimes) '±∂≤®≥§  c£∫' num2str(ctimes) '±∂≤®≥§  ∑∆ƒ˘∂˙ ˝£∫' num2str(Neq)];['¿Î…¢≥Ã∂»£∫' num2str(discrete) '  ∂…‘Ω¥Œ ˝£∫' num2str(iteration) '  ŒÛ≤Ó£∫' num2str(error*1000) '°Î  ∫ƒ ±£∫' num2str(toc) 's' ]});
    end
end
set(handles.text29,'String',num2str(iteration)); % œ‘ æ∂…‘Ω¥Œ ˝
set(handles.text27,'String',[num2str(error*1000) '°Î']); % œ‘ æŒÛ≤Ó÷µ
toc; % Õ£÷πº∆ ±
set(handles.text13,'String',[num2str(toc) ' s']); % œ‘ æ‘À–– ±º‰
guidata(hObject, handles);

% Fox_Li_1◊”∫Ø ˝_∞¥∂…‘Ω¥Œ ˝_Ãı–Õ«ª
function [m,p,err,m_pre,p_pre]=Fox_Li_1(iteration,a,k,L,discrete)
u=ones(1,discrete); % ≥ı ºªØ
u_t=zeros(1,discrete); % ≥ı ºªØ
m_pre=u;
p_pre=u_t;
x1=linspace(-a,a,discrete);
% …˙≥…“ª∏ˆΩ¯∂»Ãı
h = waitbar(0,'1','Name','’˝‘⁄º∆À„...','CreateCancelBtn','setappdata(gcbf,''canceling'',1)');
setappdata(h,'canceling',0);
for t=1:iteration % iterationŒ™∂…‘Ω¥Œ ˝
    for n=1:(discrete/2) % discreteŒ™¿Î…¢µ„ ˝
        % Check for Cancel button press
        if getappdata(h,'canceling')
            break
        end
        % Report current estimate in the waitbar's message field
        waitbar(t/iteration,h,['µ•±ﬂ∂…‘Ωµ⁄ ' num2str(t) ' ¥Œ']);
        % º∆À„’Ò∑˘
        x=x1(n);
        item=exp(-1i*k*(x-x1).^2/(2*L)).*u;
        u_t(n)=sqrt(1i*exp(-1i*k*L)) * sum(item(1:discrete));
    end
    % ¿˚”√Ω·π˚µƒ∂‘≥∆–‘£¨”≈ªØÀ„∑®
    for n=(discrete/2+1):discrete
        u_t(n)=u_t(discrete+1-n);
    end
    u=u_t; % º∆À„µ√’Ò∑˘
    u_abs=abs(u); % »°∑˘÷µ
    u_abs_max=max(u_abs); % »°◊Ó¥Û∑˘÷µ
    u=u/u_abs_max; % πÈ“ªªØµƒ’Ò∑˘
    m=u_abs/u_abs_max; % mŒ™Ω·π˚’Ò∑˘
    p=angle(u); % pŒ™Ω·π˚œ‡Œª
    if t==iteration-1 % ¥¢¥Êµπ ˝µ⁄∂˛¥ŒµƒΩ·π˚
        m_pre=u_abs/u_abs_max; % m_preŒ™µπ ˝µ⁄∂˛¥Œµƒ’Ò∑˘
        p_pre=angle(u); % p_preŒ™µπ ˝µ⁄∂˛¥Œµƒœ‡Œª
    end   
end
% º∆À„◊Ó∫Û“ª¥ŒΩ·π˚”Î…œ¥ŒΩ·π˚≤Ó
sub=m-m_pre; % º∆À„≤Ó÷µ
err=var(sub); % ”√≤Ó÷µµƒ∑Ω≤Ó±Ì’˜ŒÛ≤Ó¥Û–°
delete(h);

% Fox_Li_2◊”∫Ø ˝_∞¥ŒÛ≤Ó»›œﬁ_Ãı–Œ«ª
%  ‰≥ˆ’Ò∑˘£¨œ‡Œª£¨∂…‘Ωµƒ¥Œ ˝£¨…œ“ª∏ˆ’Ò∑˘£¨…œ“ª∏ˆœ‡Œª
%  ‰»ÎŒÛ≤Ó»›œﬁ£¨a£¨k£¨L£¨¿Î…¢≥Ã∂»
function [m,p,ite,err,m_pre,p_pre]=Fox_Li_2(error_margin,a,k,L,discrete)
u=ones(1,discrete); % ≥ı ºªØŒÔ√Ê
u_t=zeros(1,discrete); % ≥ı ºªØœÒ√Ê
u_pre=u;
m_pre=u;
x1=linspace(-a,a,discrete);
% …˙≥…“ª∏ˆΩ¯∂»Ãı
h = waitbar(0,'1','Name','’˝‘⁄º∆À„...','CreateCancelBtn','setappdata(gcbf,''canceling'',1)');
setappdata(h,'canceling',0);
err_s=inf; % ≥ı ºŒÛ≤ÓŒ™’˝Œﬁ«Ó¥Û
ite=0; % ≥ı º∂…‘Ω¥Œ ˝Œ™0
while err_s>error_margin % µ±«∞ŒÛ≤Ó¥Û”⁄ŒÛ≤Ó»›œﬁ ±
    ite=ite+1;
    for n=1:(discrete/2) % discreteŒ™¿Î…¢µ„ ˝
        % Check for Cancel button press
        if getappdata(h,'canceling')
            break
        end
        % Report current estimate in the waitbar's message field
        waitbar(error_margin/err_s,h,['µ•±ﬂ∂…‘Ωµ⁄' num2str(ite) '¥Œ£¨ƒø«∞ŒÛ≤ÓŒ™ ' num2str(err_s*1000) '°Î']);
        % º∆À„’Ò∑˘
        x=x1(n);
        item=exp(-1i*k*(x-x1).^2/(2*L)).*u;
        u_t(n)=sqrt(1i*exp(-1i*k*L)) * sum(item(1:discrete));
    end
    for n=(discrete/2+1):discrete
    u_t(n)=u_t(discrete+1-n);
    end
    u=u_t; % º∆À„µ√µƒ’Ò∑˘
    u_abs=abs(u); % »°∑˘÷µ
    u_abs_max=max(u_abs); % »°◊Ó¥Û∑˘÷µ
    u=u/u_abs_max; % πÈ“ªªØµƒ’Ò∑˘
    m=u_abs/u_abs_max; % mŒ™Ω·π˚’Ò∑˘
    p=angle(u); % pŒ™Ω·π˚œ‡Œª
    % º∆À„◊Ó∫Û“ª¥ŒΩ·π˚”Î…œ¥ŒΩ·π˚≤Ó
    sub=m-m_pre; % ≤Ó÷µ
    err_s=var(sub); % ∑Ω≤Ó£¨µ±«∞ŒÛ≤Ó
    if err_s>error_margin
        % ¥¢¥Êµπ ˝µ⁄∂˛¥ŒµƒΩ·π˚
        u_pre=u;
    end
    u_pre_abs=abs(u_pre); % »°∑˘÷µ
    u_pre_abs_max=max(u_pre_abs); % »°◊Ó¥Û∑˘÷µ
    u_pre=u_pre/u_pre_abs_max; % πÈ“ªªØµƒ’Ò∑˘
    m_pre=u_pre_abs/u_pre_abs_max; % m_preŒ™µπ ˝µ⁄∂˛¥Œµƒ’Ò∑˘
    p_pre=angle(u_pre); % p_preŒ™µπ ˝µ⁄∂˛¥Œµƒœ‡Œª
end
err=err_s;
delete(h);

% Fox_Li_3◊”∫Ø ˝_∞¥∂…‘Ω¥Œ ˝_∞ºÕπ«ª
%  ‰≥ˆ’Ò∑˘£¨œ‡Œª£¨X£¨Y£¨ŒÛ≤Ó
%  ‰»Î∂…‘Ω¥Œ ˝£¨a£¨b£¨k£¨L£¨¿Î…¢≥Ã∂»£¨±¥»˚∂˚Ω◊ ˝£¨Ω«œÚ±∂ ˝£¨∑∆ƒ˘∂˙ ˝
function [u,v,x,y,err]=Fox_Li_3(iteration,a,b,k,L,discrete,nu,dir,Neq)
g=1-L/b; % g≤Œ ˝
mm=1:discrete;
nn1=mm'; % æÿ’Û◊™÷√
besl=besselj(nu,2*pi*nn1*mm*Neq/(discrete*discrete));
q1=zeros([discrete discrete]); % ∂®“Âq1
for nn=1:discrete
    for mm=1:discrete
        q1(nn,mm)=exp(-1i*pi*g*(mm^2+nn^2)*Neq/(discrete*discrete))*mm;
    end
end
% q1_sŒ™µ¸¥˙æÿ’Û
q1_s=2*pi*1i^(nu+1)*Neq/(discrete*discrete)*exp(-1i*k*L)*q1.*besl;
s=ones(discrete,discrete);
h = waitbar(0,'1','Name','’˝‘⁄º∆À„...','CreateCancelBtn','setappdata(gcbf,''canceling'',1)');
setappdata(h,'canceling',0);
for t=1:iteration
    % Check for Cancel button press
    if getappdata(h,'canceling')
        break
    end
    % Report current estimate in the waitbar's message field
    waitbar(t/iteration,h,['∂…‘Ωµ⁄ ' num2str(t) ' ¥Œ']);
    s_t=q1_s*s; % œÒ√Ê∑÷≤ºµ»”⁄µ¸¥˙æÿ’Û≥À“‘ŒÔ√Ê∑÷≤º£¨√Ê1µΩ√Ê2
    s=s_t; % ’‚¥ŒœÒ√Êº¥œ¬¥ŒŒÔ√Ê
    s_abs=abs(s); % ∑˘÷µ
    s_abs_max=max(s_abs); % D*DµΩ1*D ◊Ó¥Û∑˘÷µ
    s_abs_max=max(s_abs_max); % 1*DµΩ1*1 ◊Ó¥Û∑˘÷µ
    s=s/s_abs_max; % πÈ“ªªØ
    m=s_abs/s_abs_max;
    p=angle(s);
    if t==iteration-1 % ¥¢¥Êµπ ˝µ⁄∂˛¥ŒµƒΩ·π˚
        m_pre=m;
    end 
end
if iteration==1 % ¥¶¿Ì∂…‘Ω¥Œ ˝Œ™1 ±µƒÃÿ ‚«Èøˆ
    m_pre=ones(discrete,discrete);
end
% º∆À„◊Ó∫Û“ª¥ŒΩ·π˚”Î…œ¥ŒΩ·π˚≤Ó
sub=m-m_pre; % º∆À„≤Ó÷µ
errr=mean(var(sub)); % ”√≤Ó÷µµƒ∑Ω≤Ó±Ì’˜ŒÛ≤Ó¥Û–°
err=-1./log(errr);

jing=1:discrete;
jing=jing';
jiao=linspace(0,2*pi,360);

u=m(jing)*abs(cos(dir*jiao)); % ◊™µΩxy◊¯±Íµƒ’Ò∑˘
v=p(jing)*abs(cos(dir*jiao)); % ◊™µΩxy◊¯±Íµƒœ‡Œª
x=a*jing/discrete*cos(jiao); % ◊™µΩxy◊¯±Íµƒx
y=a*jing/discrete*sin(jiao); % ◊™µΩxy◊¯±Íµƒy
delete(h);

% Fox_Li_4◊”∫Ø ˝_∞¥∂…‘Ω¥Œ ˝_«„–±«ª cŒ™«„–±œﬂ∂»
function [m,p,err]=Fox_Li_4(iteration,a,c,k,L,discrete)
u=ones(1,discrete); % ≥ı ºªØ
u_t=zeros(1,discrete); % ≥ı ºªØ
x1=linspace(-a,a,discrete);
% …˙≥…“ª∏ˆΩ¯∂»Ãı
h = waitbar(0,'1','Name','’˝‘⁄º∆À„...','CreateCancelBtn','setappdata(gcbf,''canceling'',1)');
setappdata(h,'canceling',0);
for t=1:iteration % iterationŒ™∂…‘Ω¥Œ ˝
    for n=1:discrete % discreteŒ™¿Î…¢µ„ ˝
        % Check for Cancel button press
        if getappdata(h,'canceling')
            break
        end
        % Report current estimate in the waitbar's message field
        waitbar(t/iteration,h,['µ•±ﬂ∂…‘Ωµ⁄ ' num2str(t) ' ¥Œ']);
        % º∆À„’Ò∑˘
        x=x1(n);
        item=exp(-1i*k*c/a*(x+x1)).*exp(-1i*k*(x-x1).^2/(2*L)).*u;
        u_t(n)=sqrt(1i*exp(-1i*k*L)) * sum(item(1:discrete));
    end
    u=u_t; % º∆À„µ√’Ò∑˘
    u_abs=abs(u); % »°∑˘÷µ
    u_abs_max=max(u_abs); % »°◊Ó¥Û∑˘÷µ
    u=u/u_abs_max; % πÈ“ªªØµƒ’Ò∑˘
    m=u_abs/u_abs_max; % mŒ™Ω·π˚’Ò∑˘
    p=angle(u); % pŒ™Ω·π˚œ‡Œª
    if t==iteration-1 % ¥¢¥Êµπ ˝µ⁄∂˛¥ŒµƒΩ·π˚
        m_pre=m;
    end   
end
if iteration==1 % ¥¶¿Ì∂…‘Ω¥Œ ˝Œ™1 ±µƒÃÿ ‚«Èøˆ
    m_pre=ones(1,discrete);
end
% º∆À„◊Ó∫Û“ª¥ŒΩ·π˚”Î…œ¥ŒΩ·π˚≤Ó
sub=m-m_pre; % º∆À„≤Ó÷µ
err=var(sub); % ”√≤Ó÷µµƒ∑Ω≤Ó±Ì’˜ŒÛ≤Ó¥Û–°
delete(h);

% Fox_Li_5◊”∫Ø ˝_∞¥ŒÛ≤Ó»›œﬁ_∞ºÕπ«ª
%  ‰≥ˆ’Ò∑˘£¨œ‡Œª£¨X£¨Y£¨∂…‘Ωµƒ¥Œ ˝£¨ŒÛ≤Ó
%  ‰»ÎŒÛ≤Ó»›œﬁ£¨a£¨b£¨k£¨L£¨¿Î…¢≥Ã∂»£¨±¥»˚∂˚Ω◊ ˝£¨Ω«œÚ±∂ ˝£¨∑∆ƒ˘∂˙ ˝
function [u,v,x,y,ite,err]=Fox_Li_5(error_margin,a,b,k,L,discrete,nu,dir,Neq)
g=1-L/b;
mm=1:discrete;
nn1=mm';
besl=besselj(nu,2*pi*nn1*mm*Neq/(discrete*discrete));
q1=zeros([discrete discrete]); % ∂®“Âq1
for nn=1:discrete
    for mm=1:discrete
        q1(nn,mm)=exp(-1i*pi*g*(mm^2+nn^2)*Neq/(discrete*discrete))*mm;
    end
end
% qŒ™µ¸¥˙æÿ’Û
q1_s=2*pi*1i^(nu+1)*Neq/(discrete*discrete)*exp(-1i*k*L)*q1.*besl;
s=ones(discrete,discrete);

err_s=inf;
ite=0;
h = waitbar(0,'1','Name','’˝‘⁄º∆À„...','CreateCancelBtn','setappdata(gcbf,''canceling'',1)');
setappdata(h,'canceling',0);
while err_s>error_margin
    ite=ite+1;
    if getappdata(h,'canceling')
        break
    end
    % Report current estimate in the waitbar's message field
    waitbar(error_margin/err_s,h,['µ•±ﬂ∂…‘Ωµ⁄' num2str(ite) '¥Œ£¨ƒø«∞ŒÛ≤ÓŒ™ ' num2str(err_s*1000) '°Î']);
    s_t=q1_s*s; % œÒ√Ê∑÷≤ºµ»”⁄µ¸¥˙æÿ’Û≥À“‘ŒÔ√Ê∑÷≤º£¨√Ê1µΩ√Ê2
    
    s_abs=abs(s); % ∑˘÷µ
    s_abs_max=max(s_abs); % D*DµΩ1*D ◊Ó¥Û∑˘÷µ
    s_abs_max=max(s_abs_max); % 1*DµΩ1*1 ◊Ó¥Û∑˘÷µ
    m_pre=s_abs/s_abs_max; % …œ“ª¥Œ’Ò∑˘∑÷≤º
    
    s=s_t; % ’‚¥ŒœÒ√Êº¥œ¬¥ŒŒÔ√Ê
    s_abs=abs(s); % ∑˘÷µ
    s_abs_max=max(s_abs); % D*DµΩ1*D ◊Ó¥Û∑˘÷µ
    s_abs_max=max(s_abs_max); % 1*DµΩ1*1 ◊Ó¥Û∑˘÷µ
    s=s/s_abs_max; % πÈ“ªªØ
    m=s_abs/s_abs_max; % ’‚“ª¥Œ’Ò∑˘∑÷≤º
    p=angle(s);
    % º∆À„◊Ó∫Û“ª¥ŒΩ·π˚”Î…œ¥ŒΩ·π˚≤Ó
    sub=m-m_pre; % º∆À„≤Ó÷µ
    errr_s=mean(var(sub)); % ”√≤Ó÷µµƒ∑Ω≤Ó±Ì’˜ŒÛ≤Ó¥Û–°
    err_s=-1./log(errr_s);
end
jing=1:discrete;
jing=jing';
jiao=linspace(0,2*pi,360);

u=m(jing)*abs(cos(dir*jiao));
v=p(jing)*abs(cos(dir*jiao));
x=a*jing/discrete*cos(jiao);
y=a*jing/discrete*sin(jiao);

err=err_s;
delete(h);

% Fox_Li_6◊”∫Ø ˝_∞¥ŒÛ≤Ó»›œﬁ_«„–±«ª
%  ‰≥ˆ’Ò∑˘£¨œ‡Œª£¨∂…‘Ωµƒ¥Œ ˝£¨ŒÛ≤Ó
%  ‰»ÎŒÛ≤Ó»›œﬁ£¨a£¨c£¨k£¨L£¨¿Î…¢≥Ã∂»
function [m,p,ite,err]=Fox_Li_6(error_margin,a,c,k,L,discrete)
u=ones(1,discrete); % ≥ı ºªØŒÔ√Ê
u_t=zeros(1,discrete); % ≥ı ºªØœÒ√Ê
u_pre=u_t;
m_pre=u_t;
x1=linspace(-a,a,discrete);
% …˙≥…“ª∏ˆΩ¯∂»Ãı
h = waitbar(0,'1','Name','’˝‘⁄º∆À„...','CreateCancelBtn','setappdata(gcbf,''canceling'',1)');
setappdata(h,'canceling',0);
err_s=inf; % ≥ı ºŒÛ≤ÓŒ™’˝Œﬁ«Ó¥Û
ite=0; % ≥ı º∂…‘Ω¥Œ ˝Œ™0
while err_s>error_margin % µ±«∞ŒÛ≤Ó¥Û”⁄ŒÛ≤Ó»›œﬁ ±
    ite=ite+1;
    for n=1:discrete % discreteŒ™¿Î…¢µ„ ˝
        % Check for Cancel button press
        if getappdata(h,'canceling')
            break
        end
        % Report current estimate in the waitbar's message field
        waitbar(error_margin/err_s,h,['µ•±ﬂ∂…‘Ωµ⁄' num2str(ite) '¥Œ£¨ƒø«∞ŒÛ≤ÓŒ™ ' num2str(err_s*1000) '°Î']);
        % º∆À„’Ò∑˘
        x=x1(n);
        item=exp(-1i*k*c/a*(x+x1)).*exp(-1i*k*(x-x1).^2/(2*L)).*u;
        u_t(n)=sqrt(1i*exp(-1i*k*L)) * sum(item(1:discrete));
    end
    u=u_t; % º∆À„µ√µƒ’Ò∑˘
    u_abs=abs(u); % »°∑˘÷µ
    u_abs_max=max(u_abs); % »°◊Ó¥Û∑˘÷µ
    u=u/u_abs_max; % πÈ“ªªØµƒ’Ò∑˘
    m=u_abs/u_abs_max; % mŒ™Ω·π˚’Ò∑˘
    p=angle(u); % pŒ™Ω·π˚œ‡Œª
    % º∆À„◊Ó∫Û“ª¥ŒΩ·π˚”Î…œ¥ŒΩ·π˚≤Ó
    sub=m-m_pre; % ≤Ó÷µ
    err_s=var(sub); % ∑Ω≤Ó£¨µ±«∞ŒÛ≤Ó
    if err_s>error_margin
        % ¥¢¥Êµπ ˝µ⁄∂˛¥ŒµƒΩ·π˚
        u_pre=u;
    end
    u_pre_abs=abs(u_pre); % »°∑˘÷µ
    u_pre_abs_max=max(u_pre_abs); % »°◊Ó¥Û∑˘÷µ
    u_pre=u_pre/u_pre_abs_max; % πÈ“ªªØµƒ’Ò∑˘
    m_pre=u_pre_abs/u_pre_abs_max; % m_preŒ™µπ ˝µ⁄∂˛¥Œµƒ’Ò∑˘
end
err=err_s;
delete(h);

% --- Executes on button press in pushbutton3.
function pushbutton3_Callback(hObject, eventdata, handles)
% hObject    handle to pushbutton3 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
% …Ë÷√÷ÿ÷√÷µ
set(handles.edit1,'String','100');
set(handles.edit3,'String','632.8');
set(handles.edit4,'String','100');
set(handles.edit3,'String','632.8');
set(handles.edit5,'String','15');
set(handles.edit6,'String','20');
set(handles.edit7,'String','200');
set(handles.edit8,'String','0');
set(handles.edit10,'String','0');
set(handles.edit13,'String','1');
set(handles.edit15,'String','1');
set(handles.edit17,'String','1');
guidata(hObject, handles);


% --- Executes on key press with focus on pushbutton1 and none of its controls.
function pushbutton1_KeyPressFcn(hObject, eventdata, handles)
% hObject    handle to pushbutton1 (see GCBO)
% eventdata  structure with the following fields (see UICONTROL)
%	Key: name of the key that was pressed, in lower case
%	Character: character interpretation of the key(s) that was pressed
%	Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed
% handles    structure with handles and user data (see GUIDATA)



function edit7_Callback(hObject, eventdata, handles)
% hObject    handle to edit7 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit7 as text
%        str2double(get(hObject,'String')) returns contents of edit7 as a double


% --- Executes during object creation, after setting all properties.
function edit7_CreateFcn(hObject, eventdata, handles)
% hObject    handle to edit7 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end

% --- Executes on selection change in popupmenu3.
function popupmenu3_Callback(hObject, eventdata, handles)
% hObject    handle to popupmenu3 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: contents = cellstr(get(hObject,'String')) returns popupmenu3 contents as cell array
%        contents{get(hObject,'Value')} returns selected item from popupmenu3
global calmeans;
calmeans=get(hObject,'Value');
if calmeans==1
    set(handles.text45,'visible','off');
else
    set(handles.text45,'visible','on');
end
guidata(hObject, handles);


% --- Executes during object creation, after setting all properties.
function popupmenu3_CreateFcn(hObject, eventdata, handles)
% hObject    handle to popupmenu3 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: popupmenu controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end
global calmeans;
calmeans=1;


% --- Executes during object creation, after setting all properties.
function axes3_CreateFcn(hObject, eventdata, handles)
% hObject    handle to axes3 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: place code in OpeningFcn to populate axes3



function edit8_Callback(hObject, eventdata, handles)
% hObject    handle to edit8 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit8 as text
%        str2double(get(hObject,'String')) returns contents of edit8 as a double


% --- Executes during object creation, after setting all properties.
function edit8_CreateFcn(hObject, eventdata, handles)
% hObject    handle to edit8 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end



function edit10_Callback(hObject, eventdata, handles)
% hObject    handle to edit10 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit10 as text
%        str2double(get(hObject,'String')) returns contents of edit10 as a double


% --- Executes during object creation, after setting all properties.
function edit10_CreateFcn(hObject, eventdata, handles)
% hObject    handle to edit10 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end



function edit13_Callback(hObject, eventdata, handles)
% hObject    handle to edit13 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit13 as text
%        str2double(get(hObject,'String')) returns contents of edit13 as a double


% --- Executes during object creation, after setting all properties.
function edit13_CreateFcn(hObject, eventdata, handles)
% hObject    handle to edit13 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end



function edit15_Callback(hObject, eventdata, handles)
% hObject    handle to edit15 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit15 as text
%        str2double(get(hObject,'String')) returns contents of edit15 as a double


% --- Executes during object creation, after setting all properties.
function edit15_CreateFcn(hObject, eventdata, handles)
% hObject    handle to edit15 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


function edit17_Callback(hObject, eventdata, handles)
% hObject    handle to edit17 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit17 as text
%        str2double(get(hObject,'String')) returns contents of edit17 as a double


% --- Executes during object creation, after setting all properties.
function edit17_CreateFcn(hObject, eventdata, handles)
% hObject    handle to edit17 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% --- Executes on button press in pushbutton6.
function pushbutton6_Callback(hObject, eventdata, handles)
% hObject    handle to pushbutton6 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
g=str2num(get(handles.edit17,'String')); % g÷µ
freN=str2num(get(handles.edit15,'String')); % ∑∆ƒ˘∂˙ ˝
wavelength = str2double(get(handles.edit3,'String'));
wavelength = wavelength*10^-9; % ≤®≥§
Ltimes = str2double(get(handles.edit4,'String'));
L = Ltimes*wavelength; % L
a=(wavelength*L*freN)^(0.5)/wavelength; % ”…NÀ„a
b=L/(1-g)/wavelength; % ”…gÀ„b
set(handles.edit6,'string',num2str(b));
set(handles.edit5,'string',num2str(a));


% --- Executes on button press in pushbutton7.
function pushbutton7_Callback(hObject, eventdata, handles)
% hObject    handle to pushbutton7 (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
wavelength = str2double(get(handles.edit3,'String'));
wavelength = wavelength*10^-9; % ≤®≥§
Ltimes = str2double(get(handles.edit4,'String'));
L = Ltimes*wavelength; % L
atimes = str2double(get(handles.edit5,'String'));
a = atimes*wavelength; % a
btimes = str2double(get(handles.edit6,'String'));
b = btimes*wavelength; % b
freN=a^2/(wavelength*L); % ”…aÀ„N
g=1-L/b; % ”…bÀ„g
set(handles.edit17,'string',num2str(g));
set(handles.edit15,'string',num2str(freN));
